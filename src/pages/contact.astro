---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Contact | House of Ray" description="Contact Nycole Ray for choreography commissions, guest artist residencies, master classes, and speaking engagements.">
  <div class="mx-auto max-w-2xl px-6 py-16 md:py-24">
    <header class="mb-12">
      <h1 class="font-serif text-4xl md:text-5xl mb-4 text-purple">Contact</h1>
      <p class="text-lg text-purple-light">
        For inquiries regarding choreography commissions, guest artist
        residencies, master classes, or speaking engagements.
      </p>
    </header>

    <div id="success-message" class="bg-cream-dark border border-mauve-light rounded-lg p-8 text-center hidden">
      <p class="text-lg text-purple font-medium mb-2">
        Thank you for your message.
      </p>
      <p class="text-purple-light">
        I'll be in touch soon.
      </p>
    </div>

    <form id="contact-form" class="space-y-6" action="https://formspree.io/f/YOUR_FORM_ID" method="POST">
      <div>
        <label for="name" class="block text-sm font-medium text-purple-dark mb-2">
          Name
        </label>
        <input
          type="text"
          id="name"
          name="name"
          required
          autocomplete="name"
          class="w-full px-4 py-3 bg-cream border border-mauve rounded-lg focus:outline-none focus:ring-2 focus:ring-purple focus:border-transparent transition-shadow text-purple-dark"
        />
      </div>

      <div>
        <label for="email" class="block text-sm font-medium text-purple-dark mb-2">
          Email
        </label>
        <input
          type="email"
          id="email"
          name="email"
          required
          autocomplete="email"
          class="w-full px-4 py-3 bg-cream border border-mauve rounded-lg focus:outline-none focus:ring-2 focus:ring-purple focus:border-transparent transition-shadow text-purple-dark"
        />
      </div>

      <div>
        <label for="subject" class="block text-sm font-medium text-purple-dark mb-2">
          Subject
        </label>
        <input
          type="text"
          id="subject"
          name="subject"
          required
          autocomplete="off"
          placeholder="Commission inquiry, masterclass booking…"
          class="w-full px-4 py-3 bg-cream border border-mauve rounded-lg focus:outline-none focus:ring-2 focus:ring-purple focus:border-transparent transition-shadow text-purple-dark placeholder:text-mauve-dark"
        />
      </div>

      <div>
        <label for="message" class="block text-sm font-medium text-purple-dark mb-2">
          Message
        </label>
        <textarea
          id="message"
          name="message"
          rows="6"
          required
          placeholder="Tell me about your project or event…"
          class="w-full px-4 py-3 bg-cream border border-mauve rounded-lg focus:outline-none focus:ring-2 focus:ring-purple focus:border-transparent transition-shadow resize-y text-purple-dark placeholder:text-mauve-dark"
        ></textarea>
      </div>

      <button
        type="submit"
        class="w-full sm:w-auto px-8 py-3 bg-gold text-purple-dark font-medium rounded-lg hover:bg-gold-light disabled:bg-mauve disabled:cursor-not-allowed transition-colors focus-visible:ring-2 focus-visible:ring-purple focus-visible:ring-offset-2"
      >
        Send Message
      </button>
    </form>
  </div>
</Layout>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const successMessage = document.getElementById('success-message');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    const submitButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
    const originalText = submitButton.textContent;
    submitButton.disabled = true;
    submitButton.innerHTML = `
      <span class="flex items-center justify-center gap-2">
        <svg class="animate-spin h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Sending…
      </span>
    `;

    try {
      const response = await fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        headers: { 'Accept': 'application/json' }
      });

      if (response.ok) {
        form.classList.add('hidden');
        successMessage?.classList.remove('hidden');
      } else {
        throw new Error('Form submission failed');
      }
    } catch (error) {
      submitButton.disabled = false;
      submitButton.textContent = originalText;
      alert('There was an error sending your message. Please try again.');
    }
  });
</script>
